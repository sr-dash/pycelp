<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1, minimum-scale=1" />
<meta name="generator" content="pdoc 0.9.2" />
<title>pycelp API documentation</title>
<meta name="description" content="[![github](https://img.shields.io/badge/GitHub-tschad%2FpyCELP-blue.svg?style=flat)](https://github.com/tschad/pycelp)
â€¦" />
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/sanitize.min.css" integrity="sha256-PK9q560IAAa6WVRRh76LtCaI8pjTJ2z11v0miyNNjrs=" crossorigin>
<link rel="preload stylesheet" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/10up-sanitize.css/11.0.1/typography.min.css" integrity="sha256-7l/o7C8jubJiy74VsKTidCy1yBkRtiUGbVkYBylBqUg=" crossorigin>
<link rel="stylesheet preload" as="style" href="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/styles/github.min.css" crossorigin>
<style>:root{--highlight-color:#fe9}.flex{display:flex !important}body{line-height:1.5em}#content{padding:20px}#sidebar{padding:30px;overflow:hidden}#sidebar > *:last-child{margin-bottom:2cm}.http-server-breadcrumbs{font-size:130%;margin:0 0 15px 0}#footer{font-size:.75em;padding:5px 30px;border-top:1px solid #ddd;text-align:right}#footer p{margin:0 0 0 1em;display:inline-block}#footer p:last-child{margin-right:30px}h1,h2,h3,h4,h5{font-weight:300}h1{font-size:2.5em;line-height:1.1em}h2{font-size:1.75em;margin:1em 0 .50em 0}h3{font-size:1.4em;margin:25px 0 10px 0}h4{margin:0;font-size:105%}h1:target,h2:target,h3:target,h4:target,h5:target,h6:target{background:var(--highlight-color);padding:.2em 0}a{color:#058;text-decoration:none;transition:color .3s ease-in-out}a:hover{color:#e82}.title code{font-weight:bold}h2[id^="header-"]{margin-top:2em}.ident{color:#900}pre code{background:#f8f8f8;font-size:.8em;line-height:1.4em}code{background:#f2f2f1;padding:1px 4px;overflow-wrap:break-word}h1 code{background:transparent}pre{background:#f8f8f8;border:0;border-top:1px solid #ccc;border-bottom:1px solid #ccc;margin:1em 0;padding:1ex}#http-server-module-list{display:flex;flex-flow:column}#http-server-module-list div{display:flex}#http-server-module-list dt{min-width:10%}#http-server-module-list p{margin-top:0}.toc ul,#index{list-style-type:none;margin:0;padding:0}#index code{background:transparent}#index h3{border-bottom:1px solid #ddd}#index ul{padding:0}#index h4{margin-top:.6em;font-weight:bold}@media (min-width:200ex){#index .two-column{column-count:2}}@media (min-width:300ex){#index .two-column{column-count:3}}dl{margin-bottom:2em}dl dl:last-child{margin-bottom:4em}dd{margin:0 0 1em 3em}#header-classes + dl > dd{margin-bottom:3em}dd dd{margin-left:2em}dd p{margin:10px 0}.name{background:#eee;font-weight:bold;font-size:.85em;padding:5px 10px;display:inline-block;min-width:40%}.name:hover{background:#e0e0e0}dt:target .name{background:var(--highlight-color)}.name > span:first-child{white-space:nowrap}.name.class > span:nth-child(2){margin-left:.4em}.inherited{color:#999;border-left:5px solid #eee;padding-left:1em}.inheritance em{font-style:normal;font-weight:bold}.desc h2{font-weight:400;font-size:1.25em}.desc h3{font-size:1em}.desc dt code{background:inherit}.source summary,.git-link-div{color:#666;text-align:right;font-weight:400;font-size:.8em;text-transform:uppercase}.source summary > *{white-space:nowrap;cursor:pointer}.git-link{color:inherit;margin-left:1em}.source pre{max-height:500px;overflow:auto;margin:0}.source pre code{font-size:12px;overflow:visible}.hlist{list-style:none}.hlist li{display:inline}.hlist li:after{content:',\2002'}.hlist li:last-child:after{content:none}.hlist .hlist{display:inline;padding-left:1em}img{max-width:100%}td{padding:0 .5em}.admonition{padding:.1em .5em;margin-bottom:1em}.admonition-title{font-weight:bold}.admonition.note,.admonition.info,.admonition.important{background:#aef}.admonition.todo,.admonition.versionadded,.admonition.tip,.admonition.hint{background:#dfd}.admonition.warning,.admonition.versionchanged,.admonition.deprecated{background:#fd4}.admonition.error,.admonition.danger,.admonition.caution{background:lightpink}</style>
<style media="screen and (min-width: 700px)">@media screen and (min-width:700px){#sidebar{width:30%;height:100vh;overflow:auto;position:sticky;top:0}#content{width:70%;max-width:100ch;padding:3em 4em;border-left:1px solid #ddd}pre code{font-size:1em}.item .name{font-size:1em}main{display:flex;flex-direction:row-reverse;justify-content:flex-end}.toc ul ul,#index ul{padding-left:1.5em}.toc > ul > li{margin-top:.5em}}</style>
<style media="print">@media print{#sidebar h1{page-break-before:always}.source{display:none}}@media print{*{background:transparent !important;color:#000 !important;box-shadow:none !important;text-shadow:none !important}a[href]:after{content:" (" attr(href) ")";font-size:90%}a[href][title]:after{content:none}abbr[title]:after{content:" (" attr(title) ")"}.ir a:after,a[href^="javascript:"]:after,a[href^="#"]:after{content:""}pre,blockquote{border:1px solid #999;page-break-inside:avoid}thead{display:table-header-group}tr,img{page-break-inside:avoid}img{max-width:100% !important}@page{margin:0.5cm}p,h2,h3{orphans:3;widows:3}h1,h2,h3,h4,h5,h6{page-break-after:avoid}}</style>
<script defer src="https://cdnjs.cloudflare.com/ajax/libs/highlight.js/10.1.1/highlight.min.js" integrity="sha256-Uv3H6lx7dJmRfRvH8TH6kJD1TSK1aFcwgx+mdg3epi8=" crossorigin></script>
<script>window.addEventListener('DOMContentLoaded', () => hljs.initHighlighting())</script>
</head>
<body>
<main>
<article id="content">
<header>
<h1 class="title">Package <code>pycelp</code></h1>
</header>
<section id="section-intro">
<p><a href="https://github.com/tschad/pycelp"><img alt="github" src="https://img.shields.io/badge/GitHub-tschad%2FpyCELP-blue.svg?style=flat"></a>
<a href="https://ui.adsabs.harvard.edu/abs/2020SoPh..295...98S/abstract"><img alt="ADS" src="https://img.shields.io/badge/NASA%20ADS-SoPh%2C%20V295%2C%207%2C%2098-red"></a></p>
<p>A <strong>py</strong>thon package for <strong>C</strong>oronal <strong>E</strong>mission <strong>L</strong>ine <strong>P</strong>olarization calculations.</p>
<p>Lead Developer: T. Schad - National Solar Observatory</p>
<p><strong>DISCLAIMER: pycelp is still in the early stages of development. Contributors are welcome. </strong></p>
<h2 id="introduction">Introduction</h2>
<p>pyCELP is used to forward synthesize the polarized emission of ionized atoms formed in the solar corona.
It calculates the atomic density matrix elements for a single ion under coronal equilibrium conditions and excited by a prescribed radiation field and thermal collisions.
In its initial release, pyCELP solves a set of statistical equilibrium equations in the spherical statistical tensor respresentation for a multi-level atom for the no-coherence case.
This approximation is useful in the case of forbidden line emission by visible and infrared lines, such as Fe XIII 1074.7 nm and Si X 3.9 um.
See
<a href="https://ui.adsabs.harvard.edu/abs/2020SoPh..295...98S/abstract">Schad &amp; Dima 2020</a> for more details and specific references.</p>
<p>A read-only Enhanced PDF version of Schad &amp; Dima 2020 is available via this <a href="https://rdcu.be/b5J2X">link</a>.</p>
<p>The original code developed by <a href="https://ui.adsabs.harvard.edu/abs/2020SoPh..295...98S/abstract">Schad &amp; Dima 2020</a> (previously referred to as pyCLE) was a Fortran based code wrapped in python.
pyCELP is a completely new implementation coded entirely in Python.
It takes advantage of specific algorithm changes, numba jit compilers, and efficient numpy linear algebra packages to provide excellent speed performance that in most cases exceeds the earlier code.
More information pertaining to numba is below.</p>
<h2 id="dependencies">Dependencies</h2>
<ul>
<li>python3, numpy, numba</li>
<li>(optional - for tests/examples) matplotlib, scipy</li>
<li>(optional - for updating docs) pdoc3</li>
<li>The <a href="http://www.chiantidatabase.org/chianti_download.html">CHIANTI atomic database</a> is also required.
(Currelty tested with v9) pyCELP will automatically search for the Chianti atomic database path using the default environment variable XUVTOP.</li>
</ul>
<h2 id="install">Install</h2>
<h3 id="conda-environment">Conda environment</h3>
<p>It is recommended to install pycelp within a conda environment.
For the best performance, it is recommended to use a version of numpy with an optimal linear algebra library, e.g. MKL for intel compilers (<a href="https://numpy.org/install/#numpy-packages--accelerated-linear-algebra-libraries">https://numpy.org/install/#numpy-packages--accelerated-linear-algebra-libraries</a>).</p>
<p>Example:</p>
<pre><code class="language-shell">$ conda create --name pycelp
$ conda activate pycelp
$ conda install python numpy scipy numba matplotlib
</code></pre>
<h3 id="downloadclone-repo">Download/clone repo</h3>
<pre><code class="language-shell">$ git clone https://github.com/tschad/pycelp.git
$ cd pycelp
$ python setup.py develop  
</code></pre>
<h2 id="example">Example</h2>
<pre><code class="language-shell">(juplab) [schad@Schad-Mac pycelp]$ python
Python 3.9.4 (default, Apr  9 2021, 09:32:38)
[Clang 10.0.0 ] :: Anaconda, Inc. on darwin
Type &quot;help&quot;, &quot;copyright&quot;, &quot;credits&quot; or &quot;license&quot; for more information.
&gt;&gt;&gt; import pycelp
&gt;&gt;&gt; fe13 = pycelp.Ion('fe_13',nlevels = 50)
 reading:  /usr/local/ssw/packages/chianti/dbase/fe/fe_13/fe_13.elvlc
 reading:  /usr/local/ssw/packages/chianti/dbase/fe/fe_13/fe_13.wgfa
 reading:  /usr/local/ssw/packages/chianti/dbase/fe/fe_13/fe_13.scups
 reading:  /usr/local/ssw/packages/chianti/dbase/fe/fe_13/fe_13.psplups
 testing default file: /usr/local/ssw/packages/chianti/dbase/abundance/sun_photospheric_2009_asplund.abund
 reading:  /usr/local/ssw/packages/chianti/dbase/abundance/sun_photospheric_2009_asplund.abund
 testing default file: /usr/local/ssw/packages/chianti/dbase/ioneq/chianti.ioneq
 reading:  /usr/local/ssw/packages/chianti/dbase/ioneq/chianti.ioneq
 setting up electron collision rate factors
 how to decide ktot here  where I also add the relaxation
 setting up proton  collision rate factors
 how to decide ktot here  where I also add the relaxation
 setting up non-dipole radiative rate factors
 getting non-dipole rate factors
 setting up dipole radiative rate factors
&gt;&gt;&gt; fe13
pyCELP Ion class
    ---------------------
    Ion Name: fe_13
    Number of energy levels included: 50
    Number of SEE equations: 142
    Number of Radiative Transitions: 366
    Ionization Equilbrium Filename: /usr/local/ssw/packages/chianti/dbase/ioneq/chianti.ioneq
&gt;&gt;&gt;
</code></pre>
<h2 id="numba-implementation-and-options">Numba implementation and options</h2>
<p>pyCELP uses numba @njit decorators for jit compiling many portions of the codebase.
In most instances, the code adopts a file-based cache for storing compiled versions of the code for later use.
The first time pyCELP is used, there is additional overhead in the time required to compile the code.
Subsequent calls are significantly faster.
If one makes modifications to the code and errors occur, it may be advised to delete the cached files the __pycache__ directory of the installed package.</p>
<p>The code does not use numba parallel options for multithreading.</p>
<p>Numba can be disabled through the use of an environmental variable (NUMBA_DISABLE) but this is not frequently used.</p>
<h2 id="numpy-libraries-for-multiprocessing">Numpy libraries for multiprocessing</h2>
<p>pyCELP uses numpy libraries which can have multithreaded modules.
If pyCELP is used in a multiprocessor application, threads need to be properly managed.</p>
<h2 id="updating-documentation">Updating documentation</h2>
<p>Code reference documentation is available at <a href="https:://tschad.github.io/pycle">tschad.github.io/pycle</a>.
These are created using pdoc3.
They are easily manually built and/or updated from the main project repo directory by using the following command.
</p>
<pre><code class="language-shell">pdoc --html --force --output-dir docs pycelp
</code></pre>
<details class="source">
<summary>
<span>Expand source code</span>
</summary>
<pre><code class="python">&#34;&#34;&#34;
.. include:: ../README.md
&#34;&#34;&#34;
from .ion import Ion as Ion</code></pre>
</details>
</section>
<section>
<h2 class="section-title" id="header-submodules">Sub-modules</h2>
<dl>
<dt><code class="name"><a title="pycelp.chianti" href="chianti.html">pycelp.chianti</a></code></dt>
<dd>
<div class="desc"><p>This module provides read routines necessary for interfacing with the Chianti
database ascii files.</p></div>
</dd>
<dt><code class="name"><a title="pycelp.collisions" href="collisions.html">pycelp.collisions</a></code></dt>
<dd>
<div class="desc"><p>This module provides functions necessary for calculating collisional rate
coefficients.</p></div>
</dd>
<dt><code class="name"><a title="pycelp.dipoles" href="dipoles.html">pycelp.dipoles</a></code></dt>
<dd>
<div class="desc"><p>This module provides functions necessary for calculating radiative rate
coefficients for dipole transitions.</p></div>
</dd>
<dt><code class="name"><a title="pycelp.ion" href="ion.html">pycelp.ion</a></code></dt>
<dd>
<div class="desc"><p>This module contains the Ion class for pycelp.</p></div>
</dd>
<dt><code class="name"><a title="pycelp.non_dipoles" href="non_dipoles.html">pycelp.non_dipoles</a></code></dt>
<dd>
<div class="desc"><p>This module provides functions necessary for calculating radiative rate
coefficients for non-dipole transitions.</p></div>
</dd>
<dt><code class="name"><a title="pycelp.util" href="util.html">pycelp.util</a></code></dt>
<dd>
<div class="desc"><p>This module provides main utility functions needed by pycelp.</p></div>
</dd>
<dt><code class="name"><a title="pycelp.wigner" href="wigner.html">pycelp.wigner</a></code></dt>
<dd>
<div class="desc"><p>This module provies functions to calculate Wigner 3j, 6j, and 9j symbols.</p></div>
</dd>
</dl>
</section>
<section>
</section>
<section>
</section>
<section>
</section>
</article>
<nav id="sidebar">
<h1>Index</h1>
<div class="toc">
<ul>
<li><a href="#introduction">Introduction</a></li>
<li><a href="#dependencies">Dependencies</a></li>
<li><a href="#install">Install</a><ul>
<li><a href="#conda-environment">Conda environment</a></li>
<li><a href="#downloadclone-repo">Download/clone repo</a></li>
</ul>
</li>
<li><a href="#example">Example</a></li>
<li><a href="#numba-implementation-and-options">Numba implementation and options</a></li>
<li><a href="#numpy-libraries-for-multiprocessing">Numpy libraries for multiprocessing</a></li>
<li><a href="#updating-documentation">Updating documentation</a></li>
</ul>
</div>
<ul id="index">
<li><h3><a href="#header-submodules">Sub-modules</a></h3>
<ul>
<li><code><a title="pycelp.chianti" href="chianti.html">pycelp.chianti</a></code></li>
<li><code><a title="pycelp.collisions" href="collisions.html">pycelp.collisions</a></code></li>
<li><code><a title="pycelp.dipoles" href="dipoles.html">pycelp.dipoles</a></code></li>
<li><code><a title="pycelp.ion" href="ion.html">pycelp.ion</a></code></li>
<li><code><a title="pycelp.non_dipoles" href="non_dipoles.html">pycelp.non_dipoles</a></code></li>
<li><code><a title="pycelp.util" href="util.html">pycelp.util</a></code></li>
<li><code><a title="pycelp.wigner" href="wigner.html">pycelp.wigner</a></code></li>
</ul>
</li>
</ul>
</nav>
</main>
<footer id="footer">
<p>Generated by <a href="https://pdoc3.github.io/pdoc"><cite>pdoc</cite> 0.9.2</a>.</p>
</footer>
</body>
</html>